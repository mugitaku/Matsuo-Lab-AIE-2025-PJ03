# 講義スライドのファクトチェック機能の実装

プロジェクトの詳細は、所定のドキュメントを確認すること。

## 実装
### 実装計画
⏺ Update Todos
  ⎿  ☐ プロジェクト構造の設計とセットアップ
     ☐ PPT/PDFファイルの読み込み機能の実装
     ☐ Google Gemini APIの統合
     ☐ ファクトチェック機能の実装
     ☐ 結果の表示・レポート機能の実装
     ☐ Webインターフェースの実装
     ☐ コスト試算機能の追加
     ☐ テストとドキュメントの作成

### 実装された機能

1. コア機能

- ファイル解析: PowerPoint (.pptx, .ppt) と PDF ファイルの読み込み
- Google Gemini API 統合: テキストと画像両方のファクトチェック
- 包括的なファクトチェック: 年代、数値、技術的主張、引用情報の検証
- 詳細レポート生成: JSON、HTML、Markdown形式での出力

2. Webアプリケーション

- 直感的なUI: ドラッグ&ドロップでファイルアップロード
- リアルタイム処理: プログレス表示付きの非同期処理
- 結果表示: 問題の深刻度別表示と改善提案
- 複数形式ダウンロード: 結果レポートの多形式エクスポート

3. コスト管理

- 事前試算: スライド数に基づく料金予測
- 実績トラッキング: 実際の使用量とコストの記録
- 規模別予測: 大量処理時のコスト見積もり

4. 拡張機能

- クイックチェック: 単一テキストの高速検証
- バッチ処理: 複数ファイルの一括処理
- 改善提案: 自動的な修正案の生成

使用方法

1. セットアップ

# 依存関係のインストール
pip install -r requirements.txt

# 環境変数の設定
cp .env.example .env
# .envファイルにGoogle Gemini APIキーを設定

2. Webアプリケーション

python app.py
# ブラウザで http://localhost:5000 にアクセス

3. コマンドライン使用例

python example_usage.py

4. テスト実行

python run_tests.py

技術仕様

- 対応ファイル: PPT, PPTX, PDF (最大100MB)
- 検出項目: 年代エラー、数値エラー、技術的主張、引用エラー、知識整合性
- コスト: 約$0.001-0.002/スライド（画像付きの場合）
- 応答速度: 20スライド程度で30-60秒

発展的な活用

このシステムは以下のような場面での活用を想定しています：

1. 講義準備: 教員が授業資料の事実確認を自動化
2. 研究発表: 学会発表前の最終チェック
3. 企業研修: 研修資料の品質保証
4. 出版社: 教材の校正作業支援

ファイル解析層

- PowerPoint解析: python-pptxでスライドごとにテキストと画像を抽出
- PDF解析: PyPDF2でテキスト抽出、pdf2imageで画像変換
- 構造化データ: 各スライドをSlideContentオブジェクトとして管理

AI処理層

- Google Gemini Pro: テキストベースのファクトチェック
- Gemini Pro Vision: 画像を含むスライドの視覚的要素も検証
- プロンプトエンジニアリング: 検証項目を明確に指定した構造化プロンプト

2. 検証メカニズム

パターンマッチング

# 検出パターンの例
self.date_pattern = re.compile(r'\b(19|20)\d{2}年?\b')
self.number_pattern = re.compile(r'\b\d+\.?\d*[KMBTG]?[Bb]?\b')
self.percentage_pattern = re.compile(r'\b\d+\.?\d*\s*[%％]\b')

AI検証プロセス

1. コンテキスト抽出: 疑わしい箇所の前後文脈を含めて送信
2. 構造化レスポンス: JSON形式で問題の種類・深刻度・修正案を取得
3. 信頼度スコア: 各検証結果に0.0-1.0の信頼度を付与

3. 検証カテゴリー

# ファクトチェックで検出する問題の種類
- date_error: 年代・日付の誤り
- numerical_error: 数値データの誤り
- technical_claim: 技術的主張の誤り
- citation_error: 引用・参照情報の誤り
- knowledge_consistency: 一般知識との不整合

4. 処理フロー

1. ファイルアップロード → ファイル形式の検証
2. コンテンツ抽出 → スライドごとにテキスト・画像を分離
3. バッチ処理 → 各スライドを並列的にGemini APIに送信
4. 結果集約 → 問題を深刻度別に分類・集計
5. レポート生成 → 多形式での出力と改善提案

5. 最適化技術

コスト最適化

- トークン数の事前推定
- バッチ処理による効率化
- キャッシュ機構（将来的な実装）

精度向上

- スライド間の整合性チェック
- 専門用語辞書との照合（拡張可能）
- 文脈を考慮した検証

6. セキュリティ・プライバシー

- APIキーの環境変数管理
- アップロードファイルの一時保存と自動削除
- HTTPSでの通信（本番環境）